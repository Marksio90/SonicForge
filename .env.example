# === SonicForge Configuration Template ===
# Copy this file to .env and fill in your actual values

# === Application Settings ===
APP_ENV=development
APP_VERSION=2.0.0
APP_DEBUG=true

# CRITICAL: Generate a secure random secret key!
# Example: python -c "import secrets; print(secrets.token_urlsafe(64))"
# This key is used for JWT token signing - keep it secret and never commit it!
SECRET_KEY=CHANGE_ME_TO_A_RANDOM_64_CHAR_SECRET_KEY_GENERATED_BY_SECRETS_MODULE

# === Database ===
DATABASE_URL=postgresql+asyncpg://sonicforge:sonicforge@postgres:5432/sonicforge
DATABASE_URL_SYNC=postgresql://sonicforge:sonicforge@postgres:5432/sonicforge

# For local development (outside Docker):
# DATABASE_URL=postgresql+asyncpg://sonicforge:sonicforge@localhost:5432/sonicforge
# DATABASE_URL_SYNC=postgresql://sonicforge:sonicforge@localhost:5432/sonicforge

# === Redis ===
REDIS_URL=redis://redis:6379/0
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/2

# For local development (outside Docker):
# REDIS_URL=redis://localhost:6379/0
# CELERY_BROKER_URL=redis://localhost:6379/1
# CELERY_RESULT_BACKEND=redis://localhost:6379/2

# === S3 / MinIO (Object Storage) ===
S3_ENDPOINT=http://minio:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin
S3_BUCKET_TRACKS=sonicforge-tracks
S3_BUCKET_VISUALS=sonicforge-visuals
S3_REGION=us-east-1

# For production, use real S3:
# S3_ENDPOINT=https://s3.amazonaws.com
# S3_ACCESS_KEY=your-aws-access-key
# S3_SECRET_KEY=your-aws-secret-key

# === Local AI Music Generation (open-source, no API key required) ===

# ACE-Step v1.5 — MIT license, primary local engine (vocals + instrumentals)
# Run: uv run acestep-api  (or docker-compose up acestep)
ACESTEP_ENABLED=true
ACESTEP_API_URL=http://acestep:7860

# Stable Audio Open Small — Stability AI Community License (commercial OK)
# Fast CPU inference: <8s per 11-second clip, ~3.6 GB RAM (INT8 quantized)
STABLE_AUDIO_ENABLED=true
STABLE_AUDIO_MODEL_ID=stabilityai/stable-audio-open-small
STABLE_AUDIO_CLIPS_PER_TRACK=8  # 8 × 11s ≈ 88s per track

# MusicGen (CC-BY-NC — non-commercial use only on pretrained weights)
# WARNING: Cannot be used for commercial streaming with pretrained weights.
MUSICGEN_MODEL_VERSION=facebook/musicgen-stereo-large
MUSICGEN_PORT=8001
MUSICGEN_API_URL=http://musicgen:8001

# === Cloud AI Music Generation APIs (optional paid fallbacks) ===

# Suno AI — $30/mo Premier = 2,000 tracks, commercial rights
SUNO_API_KEY=your-suno-api-key
SUNO_BASE_URL=https://api.suno.ai

# NOTE: Udio removed — downloads permanently disabled (UMG settlement Nov 2025)
# UDIO_API_KEY=  <- do not set

# Replicate API (cloud MusicGen, pay-per-use)
REPLICATE_API_TOKEN=your-replicate-api-token

# === TTS for Station Announcements ===
# "piper" = local ONNX (free, 10x real-time) | "openai" = $15/M chars | "none"
TTS_PROVIDER=piper
TTS_PIPER_VOICE=en_US-lessac-medium
TTS_OPENAI_VOICE=alloy
TTS_ANNOUNCEMENT_INTERVAL_MINUTES=20

# === LLM APIs (for prompt crafting & chat) ===

# Claude API (Anthropic) - recommended
ANTHROPIC_API_KEY=your-anthropic-api-key

# OpenAI API (alternative)
OPENAI_API_KEY=your-openai-api-key

# Choose which LLM to use (claude or openai)
LLM_PROVIDER=claude

# === YouTube Live Streaming ===
YOUTUBE_STREAM_KEY=your-youtube-stream-key
YOUTUBE_RTMP_URL=rtmp://a.rtmp.youtube.com/live2
YOUTUBE_API_KEY=your-youtube-data-api-v3-key

# Gyre.pro backup streaming
GYRE_STREAM_KEY=your-gyre-stream-key
GYRE_RTMP_URL=rtmp://stream.gyre.pro/live

# === MusicGen / AudioCraft Settings ===
MUSICGEN_MODEL_VERSION=facebook/musicgen-stereo-large
# Options: facebook/musicgen-stereo-large, facebook/musicgen-stereo-melody, facebook/musicgen-large
MUSICGEN_PORT=8001
MUSICGEN_API_URL=http://musicgen:8001

# === Stable Diffusion / ComfyUI (Visuals) ===
STABLE_DIFFUSION_URL=http://comfyui:7860

# === Streaming Engine (FFmpeg) ===
# Preset: ultrafast recommended for CPU-constrained laptops (2x lower CPU vs veryfast)
FFMPEG_PRESET=ultrafast
# Visualizer: showwaves | showspectrum | showfreqs | none
STREAM_VISUALIZER=showwaves
# Emergency fallback playlist directory (pre-generated tracks)
FALLBACK_PLAYLIST_DIR=/data/fallback_tracks

# === Memory Management ===
MEMORY_WARNING_MB=6000    # Warn at 6 GB RSS
MEMORY_CRITICAL_MB=7500   # Alert at 7.5 GB RSS
GC_INTERVAL_SECONDS=300   # Garbage collect every 5 minutes
PROCESS_RESTART_HOURS=12  # Restart every 12 hours as safety valve

# === CORS Settings (for frontend) ===
CORS_ORIGINS=http://localhost:3000,http://localhost:8000,http://dashboard:3000

# For production, add your domain:
# CORS_ORIGINS=https://yourdomain.com,https://dashboard.yourdomain.com

# === Monitoring & Notifications ===

# Telegram Bot (for alerts & chat interface)
TELEGRAM_BOT_TOKEN=your-telegram-bot-token
TELEGRAM_CHAT_ID=your-telegram-chat-id

# Sentry (error tracking)
SENTRY_DSN=your-sentry-dsn
SENTRY_ENVIRONMENT=development

# Jaeger (distributed tracing)
JAEGER_AGENT_HOST=localhost
JAEGER_AGENT_PORT=6831

# === Payment & Monetization (Phase 5) ===
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key
STRIPE_WEBHOOK_SECRET=whsec_your-stripe-webhook-secret

# === Rate Limiting ===
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_PERIOD=60

# === Advanced Settings ===

# Critic Agent thresholds
QUALITY_THRESHOLD=8.5
MIN_SPECTRAL_BALANCE=0.7

# Celery worker concurrency
CELERY_WORKER_CONCURRENCY=4

# Scheduler settings
SCHEDULER_LOOKAHEAD_HOURS=6
SCHEDULER_MIN_QUEUE_SIZE=10

# Audio mastering
MASTERING_TARGET_LUFS=-14.0
MASTERING_TRUE_PEAK=-1.0

# Generation settings
MAX_GENERATION_VARIANTS=5
DEFAULT_TRACK_DURATION=180

# Feature flags
ENABLE_TREND_ANALYSIS=true
ENABLE_AB_TESTING=true
ENABLE_PAYMENTS=false
ENABLE_USER_REQUESTS=true
ENABLE_CHAT_BOT=true
